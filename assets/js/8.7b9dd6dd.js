(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{354:function(a,e,t){"use strict";t.r(e);var r=t(15),s=Object(r.a)({},(function(){var a=this,e=a._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[e("h1",{attrs:{id:"软路由配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#软路由配置"}},[a._v("#")]),a._v(" 软路由配置")]),a._v(" "),e("p",[a._v("软路由插件passwall，openclash，ssrplus+ 都是可以正常使用")]),a._v(" "),e("p",[a._v("由于DNS解锁的特殊性，对于SS协议使用软路由配置可能会出现无法解锁的情况，这是由于软路由插件直接接管SS的DNS导致流量无法转发。（不是必然出现，与科学插件版本有关）")]),a._v(" "),e("Badge",{attrs:{text:"推荐落地使用V2ray或者Xray协议。",type:"error",vertical:"middle"}}),a._v(" "),e("p",[a._v("设置要点：")]),a._v(" "),e("p",[a._v("*1.必须开启UDP转发代理")]),a._v(" "),e("p",[a._v("由于奈飞TV版本的特殊性，会不定期的使用UDP协议发送数据包查询DNS，UDP数据没有被代理则有可能出现看到一半跳提示："),e("code",[a._v("奈飞检测到您可能使用了代理")])]),a._v(" "),e("p",[a._v("*2.完备的强制代理域名列表")]),a._v(" "),e("p",[a._v("可在"),e("a",{attrs:{href:"https://t.me/nfdns",target:"_blank",rel:"noopener noreferrer"}},[a._v("TG群"),e("OutboundLink")],1),a._v("内发送"),e("code",[a._v("域名规则")]),a._v("获取")]),a._v(" "),e("p",[a._v("*小提示")]),a._v(" "),e("p",[a._v("passwall中"),e("code",[a._v("高级设置")]),a._v("，UDP转发端口设置为"),e("code",[a._v("所有")])]),a._v(" "),e("p",[a._v("群友反馈")]),a._v(" "),e("p",[a._v("可能需要"),e("code",[a._v("关闭")]),a._v("软路由openwrt的turoacc组件中的"),e("code",[a._v("Shortcut-FE 流量分载")]),a._v("功能")]),a._v(" "),e("p",[a._v("如果实在都不行，可以考虑找到类似访问控制，全局控制等选项卡，将电视或者电视盒子的IP设置为完全走代理")]),a._v(" "),e("p",[a._v("部分电视APP报错使用代理也可尝试以下方法：")]),a._v(" "),e("p",[a._v("注意：需要一定的Linux基础！")]),a._v(" "),e("p",[a._v("切换到路由器的终端，比如TTYD 终端\n在尝试之前强烈建议先保存当前iptables规则")]),a._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[a._v("iptables-save "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" /etc/iptables.rules\n")])])]),e("p",[a._v("添加如下iptables规则（将192.168.5.1替换成你的路由器IP地址）：")]),a._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[a._v("iptables "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-t")]),a._v(" nat "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-A")]),a._v(" PREROUTING "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" udp "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-s")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("192.168")]),a._v(".5.1/16 "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--dport")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("53")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-j")]),a._v(" CLASH_DNS_RULE\niptables "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-t")]),a._v(" nat "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-A")]),a._v(" PREROUTING "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" tcp "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-s")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("192.168")]),a._v(".5.1/16 "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--dport")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("53")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-j")]),a._v(" CLASH_DNS_RULE\niptables "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-t")]),a._v(" nat "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-A")]),a._v(" PREROUTING "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" udp "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-s")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("192.168")]),a._v(".5.1/16 "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--dport")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("853")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-j")]),a._v(" CLASH_DNS_RULE\niptables "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-t")]),a._v(" nat "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-A")]),a._v(" PREROUTING "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" tcp "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-s")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("192.168")]),a._v(".5.1/16 "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--dport")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("853")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-j")]),a._v(" CLASH_DNS_RULE\n")])])]),e("p",[a._v("如果上面的方法也不行，请尝试添加：")]),a._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[a._v("iptables "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-t")]),a._v(" nat "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-A")]),a._v(" PREROUTING "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" udp "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--dport")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("53")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-j")]),a._v(" DNAT --to-destination "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("VPN_DNS_SERVER"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\niptables "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-t")]),a._v(" nat "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-A")]),a._v(" PREROUTING "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" tcp "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--dport")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("53")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-j")]),a._v(" DNAT --to-destination "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("VPN_DNS_SERVER"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\niptables "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-t")]),a._v(" nat "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-A")]),a._v(" PREROUTING "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" udp "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--dport")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("853")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-j")]),a._v(" DNAT --to-destination "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("VPN_DNS_SERVER"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\niptables "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-t")]),a._v(" nat "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-A")]),a._v(" PREROUTING "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" tcp "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--dport")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("853")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-j")]),a._v(" DNAT --to-destination "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("VPN_DNS_SERVER"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\n")])])]),e("p",[a._v("如果成功则不需要其他操作，如果无效可以还原")]),a._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[a._v("iptables-restore /etc/iptables.rules\n")])])]),e("p",[a._v("返回官网"),e("a",{attrs:{href:"https://nfdns.top/",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://nfdns.top/"),e("OutboundLink")],1)])],1)}),[],!1,null,null,null);e.default=s.exports}}]);